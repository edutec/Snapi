<blocks app="Snap! 4.0, http://snap.berkeley.edu" version="1"><block-definition s="crida a iCity %&apos;crida&apos; amb paràmetres %&apos;params&apos;" type="reporter" category="api"><header></header><code></code><inputs><input type="%txt"></input><input type="%mult%n"></input></inputs><script><block s="doReport"><block s="apiCall"><l><option>GET</option></l><l>http://</l><block s="reportJoinWords"><list><l>icity-239306f14390.my.apitools.com/api/</l><block var="crida"/></list></block><block var="params"/></block></block></script></block-definition><block-definition s="totes les infraestructures" type="reporter" category="api"><header></header><code></code><inputs></inputs><script><block s="doReport"><custom-block s="crida a iCity %txt amb paràmetres %mult%n"><l>infrastructures</l><list></list></custom-block></block></script></block-definition><block-definition s="totes les ciutats" type="reporter" category="api"><header></header><code></code><inputs></inputs><script><block s="doReport"><custom-block s="crida a iCity %txt amb paràmetres %mult%n"><l>cities</l><list></list></custom-block></block></script></block-definition><block-definition s="tots els dispositius" type="reporter" category="api"><header></header><code></code><inputs></inputs><script><block s="doReport"><custom-block s="crida a iCity %txt amb paràmetres %mult%n"><l>devices</l><list><l></l></list></custom-block></block></script></block-definition><block-definition s="infraestructura amb id %&apos;id&apos;" type="reporter" category="api"><header></header><code></code><inputs><input type="%n"></input></inputs><script><block s="doReport"><custom-block s="crida a iCity %txt amb paràmetres %mult%n"><block s="reportJoinWords"><list><l>infrastructures/</l><block var="id"/></list></block><list><l></l></list></custom-block></block></script></block-definition><block-definition s="ciutat amb id %&apos;id&apos;" type="reporter" category="api"><header></header><code></code><inputs><input type="%n"></input></inputs><script><block s="doReport"><custom-block s="crida a iCity %txt amb paràmetres %mult%n"><block s="reportJoinWords"><list><l>cities/</l><block var="id"/></list></block><list></list></custom-block></block></script></block-definition><block-definition s="dispositiu amb id %&apos;id&apos;" type="reporter" category="api"><header></header><code></code><inputs><input type="%n"></input></inputs><script><block s="doReport"><custom-block s="crida a iCity %txt amb paràmetres %mult%n"><block s="reportJoinWords"><list><l>devices/</l><block var="id"/></list></block><list></list></custom-block></block></script></block-definition><block-definition s="dispositius de la infraestructura amb id %&apos;id&apos;" type="reporter" category="api"><header></header><code></code><inputs><input type="%n"></input></inputs><script><block s="doReport"><custom-block s="crida a iCity %txt amb paràmetres %mult%n"><block s="reportJoinWords"><list><l>infrastructures/</l><block var="id"/><l>/devices</l></list></block><list><l></l></list></custom-block></block></script></block-definition><block-definition s="dispositius de la ciutat amb id %&apos;id&apos;" type="reporter" category="api"><header></header><code></code><inputs><input type="%n"></input></inputs><script><block s="doReport"><custom-block s="crida a iCity %txt amb paràmetres %mult%n"><block s="reportJoinWords"><list><l>cities/</l><block var="id"/><l>/devices</l></list></block><list></list></custom-block></block></script></block-definition><block-definition s="infraestructures de la ciutat amb id %&apos;id&apos;" type="reporter" category="api"><header></header><code></code><inputs><input type="%s"></input></inputs><script><block s="doReport"><block s="apiCall"><l><option>GET</option></l><l>http://</l><l>icity-239306f14390.my.apitools.com/api/infrastructures</l><list><block s="newAssociation"><l>cityID</l><block var="id"/></block></list></block></block></script></block-definition><block-definition s="dispositiu amb nom %&apos;nom&apos; de %&apos;llista&apos;" type="reporter" category="api"><header></header><code></code><inputs><input type="%txt"></input><input type="%l"></input></inputs><script><block s="doDeclareVariables"><list><l>devs</l><l>i</l></list></block><block s="doSetVar"><l>devs</l><block var="llista"/></block><block s="doSetVar"><l>i</l><l>1</l></block><block s="doWarp"><script><block s="doRepeat"><block s="reportListLength"><block var="devs"/></block><script><block s="doIf"><block s="reportEquals"><block s="valueAt"><l>name</l><block s="reportListItem"><block var="i"/><block var="devs"/></block></block><block var="nom"/></block><script><block s="doReport"><block s="reportListItem"><block var="i"/><block var="devs"/></block></block></script></block><block s="doChangeVar"><l>i</l><l>1</l></block></script></block></script></block><block s="doRun"><block s="reportJSFunction"><list></list><l>throw new Error("no s&apos;ha trobat el dispositiu")</l></block><list></list></block></script></block-definition><block-definition s="dispositius amb propietat %&apos;prop&apos; de %&apos;llista&apos;" type="reporter" category="api"><header></header><code></code><inputs><input type="%s"></input><input type="%l"></input></inputs><script><block s="doDeclareVariables"><list><l>devs</l><l>i</l><l>result</l></list></block><block s="doSetVar"><l>devs</l><block var="llista"/></block><block s="doSetVar"><l>i</l><l>1</l></block><block s="doSetVar"><l>result</l><block s="reportNewList"><list></list></block></block><block s="doWarp"><script><block s="doRepeat"><block s="reportListLength"><block var="devs"/></block><script><block s="doIf"><block s="reportListContainsItem"><block s="valueAt"><l>properties</l><block s="reportListItem"><block var="i"/><block var="devs"/></block></block><block var="prop"/></block><script><block s="doAddToList"><block s="reportListItem"><block var="i"/><block var="devs"/></block><block var="result"/></block></script></block><block s="doChangeVar"><l>i</l><l>1</l></block></script></block></script></block><block s="doReport"><block var="result"/></block></script></block-definition><block-definition s="tipus de propietats de %&apos;llista&apos;" type="reporter" category="api"><header></header><code></code><inputs><input type="%l"></input></inputs><script><block s="doDeclareVariables"><list><l>i</l><l>result</l></list></block><block s="doSetVar"><l>i</l><l>1</l></block><block s="doSetVar"><l>result</l><block s="reportNewList"><list></list></block></block><block s="doWarp"><script><block s="doRepeat"><block s="reportListLength"><block var="llista"/></block><script><block s="doDeclareVariables"><list><l>subindex</l></list></block><block s="doSetVar"><l>subindex</l><l>1</l></block><block s="doRepeat"><block s="reportListLength"><block s="valueAt"><l>properties</l><block s="reportListItem"><block var="subindex"/><block var="llista"/></block></block></block><script><block s="doIf"><block s="reportNot"><block s="reportListContainsItem"><block var="result"/><block s="reportListItem"><block var="subindex"/><block s="valueAt"><l>properties</l><block s="reportListItem"><block var="i"/><block var="llista"/></block></block></block></block></block><script><block s="doAddToList"><block s="reportListItem"><block var="subindex"/><block s="valueAt"><l>properties</l><block s="reportListItem"><block var="i"/><block var="llista"/></block></block></block><block var="result"/></block></script></block><block s="doChangeVar"><l>subindex</l><l>1</l></block></script></block><block s="doChangeVar"><l>i</l><l>1</l></block></script></block></script></block><block s="doReport"><block var="result"/></block></script></block-definition><block-definition s="dispositius de %&apos;llista&apos; a %&apos;distancia&apos; km de ( %&apos;lat&apos; , %&apos;long&apos; )" type="reporter" category="api"><header></header><code></code><inputs><input type="%l"></input><input type="%n"></input><input type="%n"></input><input type="%n"></input></inputs><script><block s="doDeclareVariables"><list><l>dispositius</l><l>i</l><l>copia de llista</l><l>factor</l></list></block><block s="doSetVar"><l>factor</l><block s="reportQuotient"><l>40000</l><l>360</l></block></block><block s="doSetVar"><l>dispositius</l><block s="reportNewList"><list></list></block></block><block s="doSetVar"><l>i</l><l>1</l></block><block s="doSetVar"><l>copia de llista</l><block var="llista"/></block><block s="doWarp"><script><block s="doRepeat"><block s="reportListLength"><block var="copia de llista"/></block><script><block s="doIf"><block s="reportAnd"><block s="reportLessThan"><block s="reportProduct"><block s="reportMonadic"><l><option>abs</option></l><block s="reportDifference"><block s="valueAt"><l>latitude</l><block s="reportListItem"><block var="i"/><block var="copia de llista"/></block></block><block var="lat"/></block></block><block var="factor"/></block><block var="distancia"/></block><block s="reportLessThan"><block s="reportProduct"><block s="reportProduct"><block s="reportMonadic"><l><option>abs</option></l><block s="reportDifference"><block s="valueAt"><l>longitude</l><block s="reportListItem"><block var="i"/><block var="copia de llista"/></block></block><block var="long"/></block></block><block var="factor"/></block><block s="reportMonadic"><l><option>sin</option></l><block s="valueAt"><l>latitude</l><block s="reportListItem"><block var="i"/><block var="copia de llista"/></block></block></block></block><block var="distancia"/></block></block><script><block s="doAddToList"><block s="reportListItem"><block var="i"/><block var="llista"/></block><block var="dispositius"/></block></script></block><block s="doChangeVar"><l>i</l><l>1</l></block></script></block></script></block><block s="doReport"><block var="dispositius"/></block></script></block-definition><block-definition s="últimes %&apos;nombre&apos; lectures de %&apos;propietat&apos; del dispositiu amb id %&apos;id&apos;" type="reporter" category="api"><header></header><code></code><inputs><input type="%n"></input><input type="%txt"></input><input type="%n"></input></inputs><script><block s="doReport"><custom-block s="crida a iCity %txt amb paràmetres %mult%n"><l>observations/last</l><list><block s="newAssociation"><l>n</l><block var="nombre"/></block><block s="newAssociation"><l>property</l><block var="propietat"/></block><block s="newAssociation"><l>id</l><block var="id"/></block></list></custom-block></block></script></block-definition></blocks>